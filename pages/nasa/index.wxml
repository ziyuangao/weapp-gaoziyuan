<!-- pages/nasa-apod/index.wxml -->
<view class="page">
  <!-- é¡¶éƒ¨æ ‡é¢˜ -->
  <view class="header">
    <text class="title">ğŸŒŒ NASA æ¯æ—¥å¤©æ–‡å›¾</text>
    <text class="subtitle">æ¢ç´¢å®‡å®™çš„å¥¥ç§˜</text>
  </view>

  <!-- ä¸»å¡ç‰‡ -->
  <view class="card" wx:if="{{imageData.title}}">
    <!-- å›¾ç‰‡åŒºåŸŸ -->
    <view class="image-container">
      <image 
        src="{{imageData.url}}" 
        mode="widthFix"
        binderror="onImageError"
        bindload="onImageLoad"
        class="main-image"
      />
      <!-- åŠ è½½é®ç½© -->
      <view class="image-loading" wx:if="{{isImageLoading}}">
        <view class="loading-spinner"></view>
        <text class="loading-text">å›¾ç‰‡åŠ è½½ä¸­...</text>
      </view>
    </view>

    <!-- ä¿¡æ¯åŒºåŸŸ -->
    <view class="info-section">
      <view class="info-header">
        <text class="image-title">{{imageData.title}}</text>
        <view class="image-subtitle">
          <text class="image-date">{{imageData.date}}</text>
          <view class="translate-btn" bindtap="onToggleTranslate">
            {{showChinese ? 'en' : 'zh'}}
          </view>
        </view>
      </view>

      <view class="info-content">
        <text class="explanation" wx:if="{{!showChinese}}">{{imageData.explanation}}</text>
        <text class="explanation" wx:if="{{showChinese}}">{{translatedText || 'ç¿»è¯‘ä¸­...'}}</text>
      </view>

      <view class="info-footer" wx:if="{{imageData.copyright}}">
        <text class="copyright">Â© {{imageData.copyright}}</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-page" wx:if="{{isLoading && !imageData.title}}">
    <view class="page-spinner"></view>
    <text class="page-loading-text">æ­£åœ¨è·å–ä»Šæ—¥å¤©æ–‡å›¾...</text>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <view 
      class="action-btn" 
      bindtap="fetchImage"
      disabled="{{isLoading || isImageLoading}}"
      loading="{{isLoading}}"
    >
      {{isLoading ? 'è·å–ä¸­...' : 'ğŸ”„ æ¢ä¸€å¼ å¤©æ–‡å›¾'}}
    </view>
    <view class="action-tip" wx:if="{{isImageLoading}}">
      å›¾ç‰‡åŠ è½½å®Œæˆåå¯åˆ‡æ¢
    </view>
  </view>

  <!-- æ•°æ®æ¥æºè¯´æ˜ -->
  <view class="footer">
    <text>æ•°æ®æ¥æºï¼šNASA Astronomy Picture of the Day API</text>
  </view>
</view>